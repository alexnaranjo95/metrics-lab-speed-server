# Server
PORT=3002

# Subpath deployment (e.g. Coolify at /metrics-lab-speed-server/)
# Set VITE_BASE_PATH when building (Docker: --build-arg VITE_BASE_PATH=/metrics-lab-speed-server/)
# VITE_BASE_PATH=/metrics-lab-speed-server/
NODE_ENV=production
LOG_LEVEL=info

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/metrics_lab_speed

# Redis (for BullMQ job queue)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# Authentication
MASTER_API_KEY=generate_a_strong_random_key_here

# Cloudflare
CLOUDFLARE_ACCOUNT_ID=your_account_id
CLOUDFLARE_API_TOKEN=your_api_token_with_pages_r2_workers_permissions

# Cloudflare Images (for image migration to CDN)
# CF_IMAGES_API_TOKEN=optional_if_using_CLOUDFLARE_API_TOKEN
# CF_IMAGES_ACCOUNT_HASH=your_account_hash_from_images_delivery_url

# Cloudflare Stream (for video facades)
# CF_STREAM_API_TOKEN=optional
# CF_STREAM_CUSTOMER_SUBDOMAIN=optional

# Cloudflare R2 (temp staging for background videos before CF Stream)
# CF_R2_ACCESS_KEY_ID=optional
# CF_R2_SECRET_ACCESS_KEY=optional
# CF_R2_BUCKET_NAME=ml-video-staging

# Dashboard webhook (where to send build status updates)
DASHBOARD_WEBHOOK_URL=https://app.metricslab.io/api/speed/webhooks/build-status

# Build workspace (persistent for checkpoint/resume)
# BUILD_WORK_DIR=./data/builds
# BUILD_CHECKPOINT_MAX_AGE_HOURS=24

# Build limits
# AI (Claude) — optional, enables AI optimization step in the pipeline
ANTHROPIC_API_KEY=sk-ant-api03-YOUR-KEY-HERE

# Google PageSpeed Insights — optional, enables real Lighthouse scoring
PAGESPEED_API_KEY=YOUR-GOOGLE-API-KEY-HERE

MAX_PAGES_PER_SITE=500
MAX_CONCURRENT_BUILDS=2
BUILD_TIMEOUT_MINUTES=30

# AI agent: page load timeout when analyzing site (default 90000 = 90s)
# AI_ANALYZER_NAV_TIMEOUT_MS=90000

# Crawl: wait after navigation for JS-rendered content (default 5000 = 5s)
# CRAWL_WAIT_AFTER_NAV_MS=5000
